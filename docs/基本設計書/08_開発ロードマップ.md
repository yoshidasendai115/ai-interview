# 8. 開発ロードマップ

## 8.1 フェーズ概要

| フェーズ | 内容 | 期間 | 状態 |
|---------|------|------|------|
| Phase 1 | 基盤構築・認証・基本画面 | 4週間 | 未実施 |
| Phase 2 | HeyGenアバター・音声認識統合 | 4週間 | 未実施 |
| Phase 3 | 評価機能・苦手分析・外部連携 | 3週間 | 未実施 |
| Phase 4 | テスト・本番リリース準備 | 3週間 | 未実施 |

**合計: 14週間（約3.5ヶ月）**

### ガントチャート

![開発ロードマップ ガントチャート](../images/開発ロードマップ_ガントチャート.png)

---

## 8.2 Phase 1: 基盤構築（4週間）

### マイルストーン

| 週 | 目標 |
|----|------|
| Week 1 | 開発環境構築、DB設計、CI/CD構築 |
| Week 2 | 認証基盤（SSO連携）、バックエンドAPI基本実装 |
| Week 3 | フロントエンド基本画面実装（テキストベース） |
| Week 4 | 結合テスト、バグ修正 |

### タスク詳細

**インフラ・環境構築**
- [ ] 開発環境Docker化
- [ ] AWSリソース構築（EC2, RDS, S3, ElastiCache）
- [ ] CI/CDパイプライン構築（GitHub Actions）
- [ ] PostgreSQLスキーマ作成（11_データベーススキーマ参照）

**認証基盤**
- [ ] mintoku work SSO連携（OAuth 2.0 / OpenID Connect）
- [ ] JWT認証実装
- [ ] セキュリティ設定（HTTPS、CORS、CSP）

**バックエンドAPI**
- [ ] FastAPIプロジェクト初期設定
- [ ] 認証API（SSO連携、トークンリフレッシュ、ログアウト）
- [ ] セッションAPI（開始、取得、回答送信、完了）
- [ ] スクリプトAPI（一覧取得、詳細取得）

**フロントエンド（ユーザー向け5画面）**
- [ ] React (Vite) プロジェクト初期設定
- [ ] SSOログイン画面（フォールバック用）
- [ ] ホーム画面（ダッシュボード、ナビゲーション）
- [ ] 面接練習画面（テキストベース版）
- [ ] フィードバック画面（スコア表示、改善ポイント）
- [ ] 学習進捗画面（グラフ、苦手項目）
- [ ] ボトムナビゲーション
- [ ] レスポンシブ対応（モバイル優先）

**テスト（Phase 1）**
- [ ] ユニットテスト（バックエンド）
- [ ] ユニットテスト（フロントエンド）
- [ ] 結合テスト（API + 画面）

---

## 8.3 Phase 2: HeyGenアバター・音声認識統合（4週間）

### マイルストーン

| 週 | 目標 |
|----|------|
| Week 5 | HeyGen SDK統合、アバター表示 |
| Week 6 | Google STT統合、リアルタイム文字起こし |
| Week 7 | 面接フロー完成（質問→回答ループ） |
| Week 8 | エラーハンドリング、UI/UX改善、統合テスト |

### タスク詳細

**HeyGen Streaming Avatar統合**
- [ ] HeyGen Streaming Avatar SDK導入
- [ ] WebRTCセッション管理
- [ ] アバター発話制御（TaskType.REPEAT）
- [ ] 発話完了イベントハンドリング
- [ ] フォールバック処理（テキストモードへの切替）

**Google Cloud STT統合**
- [ ] Google Cloud STT設定・認証
- [ ] WebSocket音声ストリーミング
- [ ] リアルタイム文字起こし表示
- [ ] 無音検出・自動停止（5秒）
- [ ] テキスト入力フォールバック

**面接フロー制御**
- [ ] 質問→回答ループ実装
- [ ] スキップ機能
- [ ] セッション状態管理（進行中、完了、中断）
- [ ] 接続ステータス表示（接続中/接続処理中/未接続）

**エラーハンドリング**
- [ ] アバター接続失敗時のリトライ・フォールバック
- [ ] マイク許可なし時の誘導ダイアログ
- [ ] 音声認識失敗時のテキスト入力切替
- [ ] ネットワーク切断時の再接続試行

**テスト（Phase 2）**
- [ ] ユニットテスト（新機能）
- [ ] 統合テスト（HeyGen + STT + 面接フロー）
- [ ] ブラウザ互換性テスト

---

## 8.4 Phase 3: 評価機能・苦手分析・外部連携（3週間）

### マイルストーン

| 週 | 目標 |
|----|------|
| Week 9 | GPT-4o評価ロジック実装（日本語能力・採用適性） |
| Week 10 | 苦手分析機能、学習進捗画面連携 |
| Week 11 | mintoku work API連携、E2Eテスト |

### タスク詳細

**GPT-4o評価機能**
- [ ] 評価API実装
- [ ] 日本語能力評価（語彙・文法・内容・敬語）
- [ ] 採用適性評価（適応力・コミュニケーション力・主体性・定着意向・協調性）
- [ ] JLPTレベル別重み付け計算
- [ ] フィードバック生成
- [ ] JLPTレベル乖離検出（7.9節参照）
- [ ] 評価結果DB保存

**苦手分析機能**
- [ ] 苦手項目検出アルゴリズム（閾値70点未満）
- [ ] 優先度計算（発生頻度 × 直近発生日）
- [ ] 苦手タグの蓄積（3回以上で記録）
- [ ] 解消条件判定（3回連続80点以上）
- [ ] 学習進捗画面への反映

**mintoku work連携**
- [ ] OAuth2 Client Credentials実装
- [ ] 結果送信API呼び出し（練習完了時）
- [ ] リトライ処理（指数バックオフ、最大3回）
- [ ] 同期ステータス管理
- [ ] エラーハンドリング・ログ記録

**テスト（Phase 3）**
- [ ] ユニットテスト（評価ロジック）
- [ ] 統合テスト（評価 + mintoku連携）
- [ ] E2Eテスト（全フロー通し）

---

## 8.5 Phase 4: テスト・本番リリース準備（3週間）

### マイルストーン

| 週 | 目標 |
|----|------|
| Week 12 | セキュリティテスト、負荷テスト |
| Week 13 | 本番環境構築、監視設定 |
| Week 14 | 最終テスト、ドキュメント整備、リリース |

### タスク詳細

**セキュリティテスト**
- [ ] OWASP Top 10脆弱性チェック
- [ ] 認証・認可テスト
- [ ] 入力バリデーションテスト
- [ ] セキュリティ監査レポート作成

**負荷テスト**
- [ ] 同時100ユーザー目標
- [ ] HeyGen/STT同時接続テスト
- [ ] API応答時間測定
- [ ] ボトルネック特定・改善

**本番環境構築**
- [ ] 本番AWSリソース構築
- [ ] SSL証明書設定
- [ ] CloudWatch監視設定
- [ ] バックアップ設定
- [ ] アラート設定

**運用準備**
- [ ] 運用マニュアル作成
- [ ] 障害対応手順書
- [ ] ドキュメント整備
- [ ] リリースチェックリスト

**最終テスト**
- [ ] 本番環境での動作確認
- [ ] ユーザー受け入れテスト（UAT）
- [ ] 最終バグ修正

---

## 8.6 テスト戦略

### テスト種別と実施タイミング

| テスト種別 | 説明 | 実施フェーズ |
|-----------|------|-------------|
| ユニットテスト | 関数・コンポーネント単位 | Phase 1-3（継続的） |
| 結合テスト | API + 画面連携 | Phase 1 |
| 統合テスト | 外部サービス連携 | Phase 2-3 |
| E2Eテスト | 全フロー通し | Phase 3 |
| セキュリティテスト | 脆弱性診断 | Phase 4 |
| 負荷テスト | 同時接続・性能 | Phase 4 |
| UAT | ユーザー受け入れ | Phase 4 |

### テストカバレッジ目標

| 対象 | 目標カバレッジ |
|------|---------------|
| バックエンドAPI | 80%以上 |
| フロントエンドコンポーネント | 70%以上 |
| 評価ロジック | 90%以上 |

---

## 8.7 依存関係図

```
Phase 1
├── インフラ基盤
│   └── 認証基盤
│       └── バックエンドAPI
│           └── フロントエンド基本画面
│
Phase 2（Phase 1完了後）
├── HeyGen統合
│   └── 面接フロー
├── Google STT統合
│   └── 面接フロー
│
Phase 3（Phase 2完了後）
├── GPT-4o評価
│   └── 苦手分析
│       └── 学習進捗画面連携
├── mintoku work連携
│
Phase 4（Phase 3完了後）
├── セキュリティテスト
├── 負荷テスト
├── 本番環境構築
└── リリース
```

---

## 8.8 リスクと対策

| リスク | 影響 | 対策 |
|--------|------|------|
| HeyGen API制限 | アバター表示不可 | テキストモードフォールバック実装 |
| STT精度不足 | 評価精度低下 | テキスト入力オプション追加 |
| GPT-4oコスト超過 | 運用費増大 | バッチ処理、キャッシュ活用 |
| mintoku work API仕様変更 | 連携失敗 | API バージョニング、互換層 |
| 開発遅延 | リリース遅延 | 週次進捗確認、バッファ期間確保 |
| セキュリティ脆弱性 | サービス停止 | Phase 4でのセキュリティ監査 |

---

## 改訂履歴

| 日付 | バージョン | 内容 |
|------|-----------|------|
| 2025-01-30 | 1.0 | 初版作成 |
| 2026-02-01 | 2.0 | 全面改訂：タスクベースでフェーズ再構成、テスト戦略追加 |
